
desc 'ManagerLib ä½¿ç”¨è¿™ä¸ªèˆªé“, å¯ä»¥å¿«é€Ÿçš„å¯¹è‡ªå·±çš„ç§æœ‰åº“, è¿›è¡Œå‡çº§ç»´æŠ¤'
desc 'éœ€è¦ä¼ çš„å‚æ•°æœ‰ ç‰ˆæœ¬ï¼ˆtagï¼‰  specçš„åå­—ï¼ˆtargetï¼‰  specåº“çš„åå­—ï¼ˆrepoï¼‰'
desc 'å¯ä»¥ç›´æ¥æ‰§è¡Œè„šæœ¬./pod_update.sh'
lane :ManagerLib do |options|

tagName = options[:tag]
targetName = options[:target]
repoName = options[:repo]

# å…·ä½“è¿™ä¸ªå··é“ä¸Šé¢æ‰§è¡Œå“ªäº›è¡Œä¸º
# 1. git add .
git_add(path: ".")
#    git commit -m 'xxx'
git_commit(path: ".", message: "ç‰ˆæœ¬å‡çº§ç»´æŠ¤")
#    git push origin master
push_to_git_remote

# éªŒè¯tagæ˜¯å¦å­˜åœ¨,å¦‚æœå­˜åœ¨, åº”è¯¥åˆ é™¤æœ¬åœ°æ ‡ç­¾å’Œè¿œç¨‹æ ‡ç­¾
#if åˆ¤æ–­æ ‡ç­¾æ˜¯å¦å­˜åœ¨
#    æ‰§è¡Œåˆ é™¤æœ¬åœ°/è¿œç¨‹æ ‡ç­¾
#end
if git_tag_exists(tag: tagName)
    UI.message("å‘ç°tag:#{tagName} å·²ç»å­˜åœ¨, å³å°†æ‰§è¡Œ, åˆ é™¤åŠ¨ä½œ ğŸš€")
    tag_delete(tag:tagName)
end

# 2. git tag æ ‡ç­¾åç§°
add_git_tag(
tag: tagName
)
#    git push --tags
push_git_tags

# 3. pod spec lint
pod_lib_lint(allow_warnings: true)
#    pod repo push XXXX xxx.podspec
pod_push(path: "#{targetName}.podspec", allow_warnings: true)


end

#fastlane ManagerLib target:LDHotFix tag:0.1.0
